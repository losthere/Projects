package com.optum.gcm.dao.constants;

public interface RetrievalSearchQueries {
	String HINT_FULL_BVF = "/*+FULL(BVF) */";
	String QUERY_SEARCH_PROJECTS = "SELECT GCM_PROJ_KEY, "
			+ "  (SELECT GCM_PROJ_NAME "
			+ "  FROM GCM_PROJECT P "
			+ "  WHERE P.GCM_PROJ_KEY= T.GCM_PROJ_KEY "
			+ "  ) GCM_PROJ_NAME, "
			+ "  (SELECT PL.GCM_PROGRAM_NAME "
			+ "  FROM GCM_PROGRAM_LIST PL "
			+ "  WHERE PL.GCM_PROGRAM_KEY = T.GCM_PROGRAM_KEY "
			+ "  ) GCM_PROGRAM_NAME, "
			+ "  BARCODE_COUNT,"
			+ "  T.GCM_PROGRAM_KEY,"
			+ "  T.GCM_PROJECT_YEAR, "
			+ "  (SELECT MAX(VR.CREATE_DATE_TIME) "
			+ "  FROM GCM_VENDOR_REQUEST VR "
			+ "  WHERE VR.REQUEST_TYPE  = 'EXTRACT' "
			+ "  AND VR.GCM_PROJ_KEY    = T.GCM_PROJ_KEY "
			+ "  AND VR.GCM_PROGRAM_KEY = T.GCM_PROGRAM_KEY "
			+ "  AND VR.GCM_PROJ_YEAR   = T.GCM_PROJECT_YEAR "
			+ "  AND VR.PROCESS_STATUS = 'COMPLETE' "
			+ "	 AND VR.GCM_VENDOR_KEY = T.GCM_VENDOR_KEY "
			+ "  ) EXTRACTED_DATE, "
			+ "  (SELECT INITCAP(VRC.REQUEST_TYPE) FROM "
			+ "  STG_VENDOR_REQUEST_CONCURRENCY VRC "
			+ "  WHERE VRC.GCM_PROJ_KEY  = T.GCM_PROJ_KEY "
			+ "  AND VRC.GCM_PROGRAM_KEY = T.GCM_PROGRAM_KEY "
			+ "  AND VRC.GCM_VENDOR_KEY = T.GCM_VENDOR_KEY "
			+ "  ) CURRENT_STATE, T.GCM_VENDOR_KEY, "
			+" (SELECT V.VENDOR_NAME " 
			+" FROM GCM_VENDOR V "
			+" WHERE V.GCM_VENDOR_KEY = T.GCM_VENDOR_KEY "
			+" ) VENDOR_NAME, "
			+" (SELECT V.IS_REAL_SW " 
			+" FROM GCM_VENDOR V "
			+" WHERE V.GCM_VENDOR_KEY = T.GCM_VENDOR_KEY "
			+" ) IS_REAL_SW "
			+ "FROM "
			+ "  ( "
			+ "SELECT #HINT# GCM_PROJ_KEY, "
			+ "    GCM_PROGRAM_KEY,"
			+ "    GCM_PROJECT_YEAR, "
			+ "    COUNT(1) BARCODE_COUNT, "
			+ "	   GCM_VENDOR_KEY "
			+ "    FROM GCM_PROJ_CONT_BUS_FUNC_VENDOR BVF "
			+ "    WHERE GCM_BUSINESS_FUNC_KEY = 4 #WHERE# "
			+ "    AND NOT EXISTS (SELECT 1 FROM STG_VENDOR_REQUEST_CONCURRENCY SVRC "
			+ "    WHERE SVRC.GCM_PROJ_KEY = BVF.GCM_PROJ_KEY AND "
			+ "    SVRC.REQUEST_TYPE = 'DELETE')"
			+ "    AND GCM_PROJ_KEY IN "
			+ "    (SELECT P.GCM_PROJ_KEY "
			+ "    FROM GCM_VENDOR V,  "  
			+ "      GCM_PROJECT P " 
			+ "    WHERE V.GCM_GROUP_KEY = :GCM_GROUP_KEY " 
			+ "    AND V.GCM_VENDOR_KEY = P.RETRIEVAL_VENDOR_KEY"
			+ "  AND P.PROJECT_STATUS NOT IN ('CLSEXT','CLSEXTCOMPLETED','CLSEXTINPROGRESS','CLSIMG','CLSIMGCOMPLETED','CLSIMGINPROGRESS','CLSVALIDATE'))"
			+ "    GROUP BY GCM_PROJ_KEY, "
			+ "    GCM_PROGRAM_KEY,"
			+ "    GCM_PROJECT_YEAR, GCM_VENDOR_KEY) T ORDER BY GCM_PROJ_KEY";

	String QUERY_EXPAND_PROJECT = "SELECT X.GCM_PROJECT_YEAR, "
			+ "  X.GCM_PROJ_KEY, "
			+ "  X.GCM_PROGRAM_KEY, "
			+ "  X.GCM_HP_KEY, "
			+ "  HP.HP_CD, "
			+ "  C.GCM_CLIENT_DESC, "
			+ "  C.GCM_CLIENT_KEY, "
			+ "  (SELECT V.VENDOR_NAME "
			+ "  FROM GCM_VENDOR V "
			+ "  WHERE V.GCM_VENDOR_KEY = X.GCM_VENDOR_KEY "
			+ "  ) VENDOR_NAME, "
			+ "  X.GCM_VENDOR_KEY, "
			+ "  X.STATUS, "
			+ "  X.STATUS_CNT, "
			+ "	 0 AS ASSIGNABLE_COUNT, " 
			+ "  0 AS COMPLETED_COUNT, " 
			+ "  0 AS EXTRACTED_COUNT, "
			+ "  0 AS TOTAL_COUNT "
			+ "FROM "
			+ "  (SELECT T.GCM_PROJECT_YEAR, "
			+ "    T.GCM_PROJ_KEY, "
			+ "    T.GCM_PROGRAM_KEY, "
			+ "    T.GCM_HP_KEY, "
			+ "    T.GCM_VENDOR_KEY, "
			+ "    T.GCM_BUS_FUNC_STATUS STATUS, "
			+ "    COUNT(1) STATUS_CNT "
			+ "  FROM "
			+ "    (SELECT BVF.GCM_PROJECT_YEAR, "
			+ "      BVF.GCM_PROJ_KEY, "
			+ "      BVF.GCM_PROGRAM_KEY, "
			+ "      BVF.GCM_HP_KEY, "
			+ "      BVF.GCM_VENDOR_KEY, "
			+ "      (CASE "
			+ "        WHEN BVF.GCM_BUS_FUNC_STATUS = 'CANCELED' "
			+ "        AND BVF.GCM_REASON_CODE     IS NOT NULL "
			+ "        THEN 'CANCELED' "
			+ "        WHEN BVF.GCM_BUS_FUNC_STATUS = 'SENT' "
			+ "        THEN 'RECVD' "
			+ "        ELSE BVF.GCM_BUS_FUNC_STATUS "
			+ "      END) GCM_BUS_FUNC_STATUS "
			+ "    FROM GCM_PROJ_CONT_BUS_FUNC_VENDOR BVF "
			+ "    WHERE BVF.GCM_BUSINESS_FUNC_KEY = 4 #WHERE# "
			+ "    ) T "
			+ "  GROUP BY T.GCM_PROJECT_YEAR, "
			+ "    T.GCM_PROJ_KEY, "
			+ "    T.GCM_PROGRAM_KEY, "
			+ "    T.GCM_HP_KEY, "
			+ "    T.GCM_VENDOR_KEY, "
			+ "    T.GCM_BUS_FUNC_STATUS "
			+ "  ) X, "
			+ "  GCM_HP HP, "
			+ "  GCM_CLIENT C "
			+ "WHERE C.GCM_CLIENT_KEY = HP.GCM_CLIENT_KEY "
			+ "AND HP.GCM_HP_KEY      = X.GCM_HP_KEY";

	String QUERY_SEARCH_BASE = "SELECT GCM_PROJECT_YEAR, GCM_PROJ_KEY, GCM_PROGRAM_KEY, GCM_HP_KEY, GCM_VENDOR_KEY, "
			+ "DECODE(CNT, '1',GCM_HP_PRODUCT,'') GCM_HP_PRODUCT FROM (SELECT t.*, COUNT(1) OVER(PARTITION BY GCM_PROGRAM_KEY, GCM_PROJ_KEY, "
			+ "GCM_PROJECT_YEAR, GCM_HP_KEY ,GCM_VENDOR_KEY) CNT, ROW_NUMBER() OVER(PARTITION BY GCM_PROJ_KEY, GCM_PROJECT_YEAR, GCM_HP_KEY, "
			+ "GCM_PROGRAM_KEY, GCM_VENDOR_KEY ORDER BY GCM_HP_KEY) RNUM FROM (SELECT DISTINCT GCM_PROJECT_YEAR, GCM_PROJ_KEY, GCM_PROGRAM_KEY, "
			+ "FUNC_VEN.GCM_HP_KEY, GCM_VENDOR_KEY, GCM_HP_PRODUCT FROM GCM_PROJ_CONT_BUS_FUNC_VENDOR FUNC_VEN, GCM_HP HP WHERE FUNC_VEN.GCM_BUSINESS_FUNC_KEY  = 4 "
			+ "AND FUNC_VEN.GCM_HP_KEY = HP.GCM_HP_KEY #WHERE#) t) " + "WHERE rnum  = 1";

	String QUERY_EXPORT_RESULTS = "SELECT * FROM (SELECT FUNC_VEN.GCM_PROJECT_YEAR, (select GCM_PROJ_NAME FROM GCM_PROJECT P "
			+ "WHERE P.GCM_PROJ_KEY = FUNC_VEN.GCM_PROJ_KEY) PROJ_NAME, FUNC_VEN.GCM_PROJ_KEY, (SELECT GCM_PROGRAM_DESC FROM GCM_PROGRAM_LIST PL "
			+ "WHERE pl.GCM_PROGRAM_KEY = FUNC_VEN.GCM_PROGRAM_KEY) GCM_PROGRAM_DESC, FUNC_VEN.GCM_PROGRAM_KEY, (SELECT HP_DESC FROM GCM_HP H "
			+ "WHERE H.GCM_HP_KEY = FUNC_VEN.GCM_HP_KEY) HP_DESC, FUNC_VEN.GCM_HP_KEY, (CASE WHEN FUNC_VEN.GCM_VENDOR_KEY IS NOT NULL THEN "
			+ "(SELECT VENDOR_NAME FROM GCM_VENDOR H WHERE H.GCM_VENDOR_KEY = FUNC_VEN.GCM_VENDOR_KEY) ELSE '' END) VENDOR_NAME, "
			+ "NVL(FLTR.GCM_HP_PRODUCT,'MULTIPLE') GCM_HP_PRODUCT, (SELECT GCM_CLIENT_CD from GCM_CLIENT CLNT, GCM_HP HP WHERE "
			+ "CLNT.GCM_CLIENT_KEY = HP.GCM_CLIENT_KEY AND HP.GCM_HP_KEY = FUNC_VEN.GCM_HP_KEY) GCM_CLIENT_DESC, "
			+ "(SELECT TO_CHAR(MAX(CREATE_DATE_TIME),'mm/dd/yyyy')  FROM GCM_VENDOR_REQUEST VR  WHERE VR.REQUEST_TYPE  = 'EXTRACT'  AND VR.PROCESS_STATUS  = 'COMPLETE'  AND "
			+ "VR.GCM_PROJ_KEY = FUNC_VEN.GCM_PROJ_KEY  AND VR.GCM_PROGRAM_KEY = FUNC_VEN.GCM_PROGRAM_KEY  AND VR.GCM_HP_KEY = FUNC_VEN.GCM_HP_KEY  AND "
			+ "VR.GCM_PROJ_YEAR = FUNC_VEN.GCM_PROJECT_YEAR  AND VR.GCM_VENDOR_KEY  = FUNC_VEN.GCM_VENDOR_KEY  ) EXTRACT_DT, "
			+ "NVL(FUNC_VEN.GCM_VENDOR_KEY,0) GCM_VENDOR_KEY, FUNC_VEN.GCM_PROJECT_CONTENT_KEY, ( CASE WHEN FUNC_VEN.GCM_BUS_FUNC_STATUS = 'CANCELED' "
			+ "AND FUNC_VEN.GCM_REASON_CODE  IS NOT NULL THEN 'CANCELLED' WHEN FUNC_VEN.GCM_BUS_FUNC_STATUS = 'SENT' THEN 'RECVD' ELSE "
			+ "FUNC_VEN.GCM_BUS_FUNC_STATUS END) GCM_BUS_FUNC_STATUS  FROM GCM_PROJ_CONT_BUS_FUNC_VENDOR FUNC_VEN, ( #BASE_QUERY# ) FLTR  "
			+ "WHERE FUNC_VEN.GCM_PROJECT_YEAR = FLTR.GCM_PROJECT_YEAR  AND FUNC_VEN.GCM_PROJ_KEY = FLTR.GCM_PROJ_KEY  AND "
			+ "FUNC_VEN.GCM_PROGRAM_KEY = FLTR.GCM_PROGRAM_KEY AND FUNC_VEN.GCM_HP_KEY = FLTR.GCM_HP_KEY AND "
			+ "NVL(FUNC_VEN.GCM_VENDOR_KEY,0) = NVL(FLTR.GCM_VENDOR_KEY,0) AND (FLTR.GCM_HP_PRODUCT IS NULL  OR "
			+ "FUNC_VEN.GCM_HP_PRODUCT = FLTR.GCM_HP_PRODUCT) AND FUNC_VEN.GCM_PROJECT_CONTENT_KEY = FUNC_VEN.GCM_PROJECT_CONTENT_KEY "
			+ "AND FUNC_VEN.GCM_BUSINESS_FUNC_KEY = 4 ) PIVOT(COUNT(GCM_PROJECT_CONTENT_KEY) FOR GCM_BUS_FUNC_STATUS IN(#VALID_STATUS#))";

	String QUERY_HP_BY_PROJECT = "SELECT DISTINCT GCM_HP_KEY FROM GCM_PROJ_CONT_BUS_FUNC_VENDOR BFV WHERE BFV.GCM_BUSINESS_FUNC_KEY = 4 #WHERE#";
	
	
	String QUERY_USER_HAS_PROGRAMS = "SELECT 'YES' RESULT FROM GCM_USER_SKILL US, GCM_USER U WHERE "
			+ "US.GCM_SKILL_TYPE_KEY = 5 AND US.GCM_USER_KEY = U.GCM_USER_KEY AND U.USERID = :USERID AND ROWNUM =1";

	String QUERY_USER_HAS_BUS_SEGMENTS = "SELECT 'YES' RESULT FROM GCM_USER_SKILL US, GCM_USER U WHERE "
			+ "US.GCM_SKILL_TYPE_KEY = 4 AND US.GCM_USER_KEY = U.GCM_USER_KEY AND U.USERID = :USERID AND ROWNUM =1";

	String QUERY_VALIDATE_DELETE_COMP = "select 'YES' status from GCM_PROJ_CONT_BUS_FUNC_VENDOR where GCM_PROJ_KEY = :PROJ_KEY "
			+ "AND GCM_PROJECT_YEAR = :PROJ_YEAR and GCM_BUSINESS_FUNC_KEY = 4 and GCM_BUS_FUNC_STATUS in (select GCM_BUS_FUNC_STATUS from "
			+ "GCM_BUS_FUNC_STATUS where GCM_BUSINESS_FUNC_KEY = 4 and GCM_BUS_FUNC_STATUS_GROUP = 'COMPLETED') and rownum =1";

	String QUERY_HAS_VALID_SUP_RECS = "SELECT 1 AS VALID FROM GCM_PROJ_CONTENT_EXTENT CONT_EXT, "
			+ "GCM_PROJ_CONT_BUS_FUNC_VENDOR FUNC_VEN WHERE FUNC_VEN.GCM_PROJECT_CONTENT_KEY = CONT_EXT.GCM_PROJECT_CONTENT_KEY AND "
			+ "CONT_EXT.GCM_PROJ_KEY = :PROJ_KEY AND CONT_EXT.GCM_PROGRAM_KEY = :GCM_PROGRAM_KEY AND CONT_EXT.GCM_HP_KEY = :GCM_HP_KEY AND "
			+ "CONT_EXT.GCM_PROJECT_YEAR = :PROJ_YEAR  AND (:GCM_VENDOR_KEY = 0 OR FUNC_VEN.GCM_VENDOR_KEY = :GCM_VENDOR_KEY) AND "
			+ "(:HP_PRODUCT IS NULL OR CONT_EXT.GCM_HP_PRODUCT = :HP_PRODUCT) AND ((:GCM_BUS_FUNC_STATUS IS NULL AND ((:REQUEST_TYPE = 'EXTRACT' AND "
			+ "NVL(FUNC_VEN.GCM_REASON_CODE,'*') <> 'ONC') OR :REQUEST_TYPE = 'REVIEW-EXTRACT')) "
			+ "OR FUNC_VEN.GCM_BUS_FUNC_STATUS IN (:GCM_BUS_FUNC_STATUS,:GCM_BUS_FUNC_STATUS1)) AND ROWNUM = 1";

	String QUERY_ASSIGN_FILE_CHECK = "SELECT 1 flag FROM frmk_stg_fileinfo file_info WHERE file_name LIKE 'VENDOR_ASSIGN%' AND "
			+ "file_info.process_sts_key IN (2,3) AND EXISTS(SELECT 1 FROM stg_assign_vendor ass_ven, gcm_proj_content cont, "
			+ "table(fnc_parse_ser_cnt_params_list(:SEL_PROJ_DET)) filt WHERE file_info.file_key = ass_ven.file_key AND "
			+ "ass_ven.business_func_cd = 'RETRIEVAL'AND ass_ven.gcm_proj_content_barcode = cont.gcm_proj_content_barcode AND "
			+ "cont.gcm_proj_key = filt.gcm_proj_key AND cont.gcm_program_key = filt.gcm_program_key AND cont.gcm_hp_key = filt.gcm_hp_key)";

	String QUERY_SUPPLEMENT_MISSING = "SELECT 1 AS FLAG FROM GCM_PROJ_CONT_BUS_FUNC_VENDOR BUS_VEN WHERE "
			+ "GCM_PROJ_KEY = :PROJ_KEY AND GCM_PROGRAM_KEY = :GCM_PROGRAM_KEY AND GCM_HP_KEY = :GCM_HP_KEY AND GCM_PROJECT_YEAR = :PROJ_YEAR "
			+ "AND GCM_VENDOR_KEY = :GCM_VENDOR_KEY AND (:HP_PRODUCT IS NULL OR GCM_HP_PRODUCT = :HP_PRODUCT) AND GCM_BUSINESS_FUNC_KEY = :GCM_BUSINESS_FUNC_KEY AND "
			+ "(:GCM_BUS_FUNC_STATUS IS NULL OR BUS_VEN.GCM_BUS_FUNC_STATUS = :GCM_BUS_FUNC_STATUS) AND NOT EXISTS "
			+ "(SELECT 1 FROM GCM_PROJ_CONTENT_EXTENT WHERE GCM_PROJECT_CONTENT_KEY = BUS_VEN.GCM_PROJECT_CONTENT_KEY ) AND ROWNUM = 1";

	String QUERY_RETRIEVAL_SEARCH_TOTAL_CNT = "SELECT COUNT(1) TOTAL_CNT FROM (#BASE_QUERY#)";

	String QUERY_UPDATE_PROJECT = "update GCM_PROJECT set GCM_PROJ_NAME = 'DELETED - ' || GCM_PROJ_KEY || ' - ' || TO_CHAR(sysdate,'mmddyyyyhh24miss'), "
			+ "MODIFY_USERID = :USER_ID, MODIFY_DATE_TIME = sysdate, SUPPLEMENT_KEY = '' where GCM_PROJ_KEY = :PROJ_KEY";
	
	String QUERY_GET_ASSIGNABLE_VENDORS = "SELECT GCM_VENDOR_KEY AS KEY, VENDOR_NAME AS VALUE FROM TABLE(PKG_VENDOR_PROCESSING.FNC_RETRIEVAL_VENDOR(:P_PROJ_DET,:P_BUSINESS_SEGMENT))";
	
	String QUERY_GET_ASSIGNABLE_VENDORS_BY_HP_CLIENT = "SELECT GCM_VENDOR_KEY AS KEY, VENDOR_NAME AS VALUE  FROM TABLE"
			+ "(PKG_VENDOR_PROCESSING.FNC_HP_RETRIEVAL_VENDOR(:P_USER_KEY,:P_GROUP_KEY,:P_VENDOR_KEY,:P_REC_BUSINESS_SEGMENT,"
			+ ":P_REC_PROJ_KEY,:P_REC_PROGRAM_KEY,:P_REC_VENDOR_KEY,:P_REC_HP_KEY,:P_REC_CLIENT_KEY))";
}
